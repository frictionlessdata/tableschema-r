<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Table Schema Frictionless Data • tableschema.r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Table Schema Frictionless Data">
<meta property="og:description" content="Allows to work with Table Schema (&lt;http://specs.frictionlessdata.io/table-schema/&gt;). Table Schema is well suited for use cases around handling and validating tabular data in text formats such as csv, but its utility extends well beyond this core usage, towards a range of applications where data benefits from a portable schema format. The tableschema.r package can load and validate any table schema descriptor, allow the creation and modification of descriptors, expose methods for reading and streaming data that conforms to a Table Schema via the Tabular Data Resource abstraction.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tableschema.r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/frictionlessdata/tableschema-r">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><img src="okgr.png" align="right" width="100px"><img src="oklabs.png" align="right" width="100px"><br><br><br><img src="Ffrictionless.png" align="left" width="120"><br>rictionless Data - <br>Table Schema ================</p>
<p><a href="https://cran.r-project.org/package=tableschema.r"><embed src="https://www.r-pkg.org/badges/version/tableschema.r"></embed></a> <a href="https://travis-ci.org/frictionlessdata/tableschema-r"><img src="https://travis-ci.org/frictionlessdata/tableschema-r.svg?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/r/frictionlessdata/tableschema-r?branch=master"><img src="https://coveralls.io/repos/github/frictionlessdata/tableschema-r/badge.svg" alt="Coverage status"></a> <a href="https://github.com/frictionlessdata/tableschema-r/issues"><img src="http://githubbadges.herokuapp.com/frictionlessdata/tableschema-r/issues.svg" alt="Github Issues"></a> <a href="https://github.com/frictionlessdata/tableschema-r/pulls"><img src="http://githubbadges.herokuapp.com/frictionlessdata/tableschema-r/pulls.svg" alt="Pending Pull-Requests"></a> <a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://cran.r-project.org/"><img src="https://img.shields.io/badge/R%3E%3D-3.6-6666ff.svg" alt="minimal R version"></a> <a href="http://www.rdocumentation.org/packages/tableschema.r"><embed src="http://www.rdocumentation.org/badges/version/tableschema.r"></embed></a> <a href="http://cran.rstudio.com/web/packages/tableschema.r/index.html"><embed src="http://cranlogs.r-pkg.org/badges/grand-total/tableschema.r"></embed></a> <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/licence-MIT-blue.svg" alt="Licence"></a> <a href="https://gitter.im/frictionlessdata/chat"><img src="https://img.shields.io/gitter/room/nwjs/nw.js.svg" alt="Gitter"></a></p>
<div id="description" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h1></div>
<p>R library for working with <a href="http://specs.frictionlessdata.io/table-schema/">Table Schema</a>.</p>
</div>
<div id="features" class="section level1">
<h1 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h1>
<ul>
<li>
<code>Table</code> class for working with data and schema</li>
<li>
<code>Schema</code> class for working with schemas</li>
<li>
<code>Field</code> class for working with schema fields</li>
<li>
<code>validate</code> function for validating schema descriptors</li>
<li>
<code>infer</code> function that creates a schema based on a data sample</li>
</ul>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>In order to install the latest distribution of <a href="https://www.r-project.org/">R software</a> to your computer you have to select one of the mirror sites of the <a href="https://cran.r-project.org/">Comprehensive R Archive Network</a>, select the appropriate link for your operating system and follow the wizard instructions.</p>
<p>For windows users you can:</p>
<ol>
<li>Go to CRAN</li>
<li>Click download R for Windows</li>
<li>Click Base (This is what you want to install R for the first time)</li>
<li>Download the latest R version</li>
<li>Run installation file and follow the instrustions of the installer.</li>
</ol>
<p>(Mac) OS X and Linux users may need to follow different steps depending on their system version to install R successfully and it is recommended to read the instructions on CRAN site carefully.</p>
<p>Even more detailed installation instructions can be found in <a href="https://cran.r-project.org/doc/manuals/R-admin.html">R Installation and Administration manual</a>.</p>
<p>To install <a href="https://www.rstudio.com/">RStudio</a>, you can download <a href="https://www.rstudio.com/products/rstudio/download/">RStudio Desktop</a> with Open Source License and follow the wizard instructions:</p>
<ol>
<li>Go to <a href="https://www.rstudio.com/products/rstudio/">RStudio</a>
</li>
<li>Click download on RStudio Desktop</li>
<li>Download on RStudio Desktop free download</li>
<li>Select the appropriate file for your system</li>
<li>Run installation file</li>
</ol>
<p>To install the <code>tableschema</code> library it is necessary to install first <code>devtools</code> library to make installation of github libraries available.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Install devtools package if not already</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)</a></code></pre></div>
<p>Install <code>tableschema.r</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># from CRAN version</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"tableschema.r"</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># or install the development version from github</span></a>
<a class="sourceLine" id="cb2-5" title="5">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"frictionlessdata/tableschema-r"</span>)</a></code></pre></div>
</div>
<div id="load-library" class="section level2">
<h2 class="hasAnchor">
<a href="#load-library" class="anchor"></a>Load library</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Install devtools package if not already</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co"># install.packages("jsonlite")</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(jsonlite)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Install devtools package if not already</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># install.packages("future")</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(future)</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co"># load the library using</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tableschema.r)</a></code></pre></div>
</div>
</div>
<div id="documentation" class="section level1">
<h1 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h1>
<p><a href="https://CRAN.R-project.org/package=jsonlite">Jsonlite package</a> is internally used to convert json data to list objects. The input parameters of functions could be json strings, files or lists and the outputs are in list format to easily further process your data in R environment and exported as desired. The examples below show how to use jsonlite package to convert the output back to json adding indentation whitespace. More details about handling json you can see jsonlite documentation or vignettes <a href="https://CRAN.R-project.org/package=jsonlite">here</a>.</p>
<p>Moreover <a href="https://CRAN.R-project.org/package=future">future package</a> is also used to load and create Table and Schema classes asynchronously. To retrieve the actual result of the loaded Table or Schema you have to use <code>value(...)</code> to the variable you stored the loaded Table/Schema. More details about future package and sequential and parallel processing you can find <a href="https://CRAN.R-project.org/package=future">here</a>.</p>
<div id="working-with-table" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-table" class="anchor"></a>Working with Table</h2>
<p>A table is a core concept in a tabular data world. It represents a data with a metadata (Table Schema). Let’s see how we could use it in practice.</p>
<p>Consider we have some local csv file. It could be inline data or remote link - all supported by <code>Table</code> class (except local files for in-brower usage of course). But say it’s <code>data.csv</code> for now:</p>
<blockquote>
<p>data/cities.csv</p>
</blockquote>
<pre class="csv"><code>city,location
london,"51.50,-0.11"
paris,"48.85,2.30"
rome,N/A</code></pre>
<p>Let’s create and read a table. We use static <code>Table.load</code> method and <code>table.read</code> method with a <code>keyed</code> option to get list of keyed rows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">def =<span class="st"> </span><span class="kw"><a href="reference/Table.load.html">Table.load</a></span>(<span class="st">'inst/extdata/data.csv'</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">table =<span class="st"> </span><span class="kw">value</span>(def)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co"># add indentation whitespace to JSON output with jsonlite package</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">toJSON</span>(table<span class="op">$</span><span class="kw">read</span>(<span class="dt">keyed =</span> <span class="ot">TRUE</span>), <span class="dt">pretty =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">## [</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">##   {</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">##     "city": ["london"],</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">##     "location": ["\"51.50 -0.11\""]</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">##   },</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">##   {</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">##     "city": ["paris"],</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">##     "location": ["\"48.85 2.30\""]</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">##   },</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">##   {</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">##     "city": ["rome"],</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">##     "location": ["N/A"]</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">##   }</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">## ]</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">table.headers =<span class="st"> </span>table<span class="op">$</span>headers </a>
<a class="sourceLine" id="cb7-2" title="2">table.headers</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">## [1] "city"</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">## [1] "location"</span></a></code></pre></div>
<p>As we could see our locations are just a strings. But it should be geopoints. Also Rome’s location is not available but it’s also just a <code>N/A</code> string instead of <code>null</code>. First we have to infer Table Schema:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># add indentation whitespace to JSON output with jsonlite package</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">toJSON</span>(table<span class="op">$</span><span class="kw"><a href="reference/infer.html">infer</a></span>(), <span class="dt">pretty =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">## {</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">##   "fields": [</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">##       "name": ["city"],</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">##       "type": ["string"],</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">##       "name": ["location"],</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">##       "type": ["string"],</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">##     }</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">##   ],</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">##   "missingValues": [</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">##     [""]</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">##   ]</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">## }</span></a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">toJSON</span>(table<span class="op">$</span>schema<span class="op">$</span>descriptor, <span class="dt">pretty =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">## {</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">##   "fields": [</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">##       "name": ["city"],</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">##       "type": ["string"],</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">##       "name": ["location"],</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">##       "type": ["string"],</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">##     }</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">##   ],</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">##   "missingValues": [</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">##     [""]</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">##   ]</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">## }</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">table<span class="op">$</span><span class="kw">read</span>(<span class="dt">keyed =</span> <span class="ot">TRUE</span>) <span class="co"># Fails</span></a></code></pre></div>
<p>Let’s fix not available location. There is a <code>missingValues</code> property in Table Schema specification. As a first try we set <code>missingValues</code> to <code>N/A</code> in <code>table$schema$descriptor</code>. Schema descriptor could be changed in-place but all changes should be commited by <code>table$schema$commit()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">table<span class="op">$</span>schema<span class="op">$</span>descriptor[<span class="st">'missingValues'</span>] =<span class="st"> 'N/A'</span></a>
<a class="sourceLine" id="cb14-2" title="2">table<span class="op">$</span>schema<span class="op">$</span><span class="kw">commit</span>()</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co">## [1] TRUE</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">table<span class="op">$</span>schema<span class="op">$</span>valid <span class="co"># false</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">## [1] FALSE</span></a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">table<span class="op">$</span>schema<span class="op">$</span>errors</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">## [1] "Descriptor validation error:\n            data.missingValues - is the wrong type"</span></a></code></pre></div>
<p>As a good citiziens we’ve decided to check out schema descriptor validity. And it’s not valid! We sould use an list for <code>missingValues</code> property. Also don’t forget to have an empty string as a missing value:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">table<span class="op">$</span>schema<span class="op">$</span>descriptor[[<span class="st">'missingValues'</span>]] =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">""</span>, <span class="st">'N/A'</span>)</a>
<a class="sourceLine" id="cb20-2" title="2">table<span class="op">$</span>schema<span class="op">$</span><span class="kw">commit</span>()</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co">## [1] TRUE</span></a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">table<span class="op">$</span>schema<span class="op">$</span>valid <span class="co"># true</span></a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co">## [1] TRUE</span></a></code></pre></div>
<p>All good. It looks like we’re ready to read our data again:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">table<span class="op">$</span><span class="kw">read</span>() <span class="co"># or</span></a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">toJSON</span>(table<span class="op">$</span><span class="kw">read</span>(), <span class="dt">pretty =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<p>Now we see that:</p>
<ul>
<li><p>locations are lists with numeric lattide and longitude</p></li>
<li><p>Rome’s location is <code>null</code></p></li>
</ul>
<p>And because there are no errors on data reading we could be sure that our data is valid againt our schema. Let’s save it:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">table<span class="op">$</span>schema<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="st">'schema.json'</span>)</a>
<a class="sourceLine" id="cb26-2" title="2">table<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="st">'data.csv'</span>)</a></code></pre></div>
<p>Our <code>data.csv</code> looks the same because it has been stringified back to <code>csv</code> format. But now we have <code>schema.json</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb27-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="dt">"fields"</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="fu">{</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="dt">"name"</span><span class="fu">:</span> <span class="st">"city"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"string"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="dt">"format"</span><span class="fu">:</span> <span class="st">"default"</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="fu">{</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="dt">"name"</span><span class="fu">:</span> <span class="st">"location"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"geopoint"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="dt">"format"</span><span class="fu">:</span> <span class="st">"default"</span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="fu">}</span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="dt">"missingValues"</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="st">""</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="st">"N/A"</span></a>
<a class="sourceLine" id="cb27-17" title="17"><span class="ot">]</span></a>
<a class="sourceLine" id="cb27-18" title="18"><span class="fu">}</span></a></code></pre></div>
<p>If we decide to improve it even more we could update the schema file and then open it again. But now providing a schema path.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">def =<span class="st"> </span><span class="kw"><a href="reference/Table.load.html">Table.load</a></span>(<span class="st">'inst/extdata/data.csv'</span>, <span class="dt">schema =</span> <span class="st">'inst/extdata/schema.json'</span>)</a>
<a class="sourceLine" id="cb28-2" title="2">table =<span class="st"> </span><span class="kw">value</span>(def)</a>
<a class="sourceLine" id="cb28-3" title="3">table</a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">## &lt;Table&gt;</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co">##   Public:</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co">##     clone: function (deep = FALSE) </span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co">##     headers: active binding</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co">##     infer: function (limit = 100) </span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="co">##     initialize: function (src, schema = NULL, strict = FALSE, headers = 1) </span></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="co">##     iter: function (keyed, extended, cast = TRUE, relations = FALSE, stream = FALSE) </span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="co">##     read: function (keyed = FALSE, extended = FALSE, cast = TRUE, relations = FALSE, </span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="co">##     save: function (connection) </span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="co">##     schema: active binding</span></a>
<a class="sourceLine" id="cb29-11" title="11"><span class="co">##   Private:</span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="co">##     createRowStream_: function (src) </span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="co">##     createUniqueFieldsCache: function (schema) </span></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="co">##     currentStream_: NULL</span></a>
<a class="sourceLine" id="cb29-15" title="15"><span class="co">##     headers_: NULL</span></a>
<a class="sourceLine" id="cb29-16" title="16"><span class="co">##     headersRow_: 1</span></a>
<a class="sourceLine" id="cb29-17" title="17"><span class="co">##     rowNumber_: 0</span></a>
<a class="sourceLine" id="cb29-18" title="18"><span class="co">##     schema_: Schema, R6</span></a>
<a class="sourceLine" id="cb29-19" title="19"><span class="co">##     src: inst/extdata/data.csv</span></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="co">##     strict_: FALSE</span></a>
<a class="sourceLine" id="cb29-21" title="21"><span class="co">##     uniqueFieldsCache_: list</span></a></code></pre></div>
<p>It was only basic introduction to the <code>Table</code> class. To learn more let’s take a look on <code>Table</code> class API reference.</p>
</div>
<div id="working-with-schema" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-schema" class="anchor"></a>Working with Schema</h2>
<p>A model of a schema with helpful methods for working with the schema and supported data. Schema instances can be initialized with a schema source as a url to a JSON file or a JSON object. The schema is initially validated (see <a href="#validate">validate</a> below). By default validation errors will be stored in <code>schema$errors</code> but in a strict mode it will be instantly raised.</p>
<p>Let’s create a blank schema. It’s not valid because <code>descriptor$fields</code> property is required by the <a href="http://specs.frictionlessdata.io/table-schema/">Table Schema</a> specification:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">def =<span class="st"> </span><span class="kw"><a href="reference/Schema.load.html">Schema.load</a></span>({})</a>
<a class="sourceLine" id="cb30-2" title="2">schema =<span class="st"> </span><span class="kw">value</span>(def)</a>
<a class="sourceLine" id="cb30-3" title="3">schema<span class="op">$</span>valid <span class="co"># false</span></a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">## [1] FALSE</span></a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">schema<span class="op">$</span>errors</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co">## [1] "Descriptor validation error:\n            data.fields - is required"</span></a></code></pre></div>
<p>To do not create a schema descriptor by hands we will use a <code>schema$infer</code> method to infer the descriptor from given data:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">toJSON</span>(</a>
<a class="sourceLine" id="cb34-2" title="2">  schema<span class="op">$</span><span class="kw"><a href="reference/infer.html">infer</a></span>(<span class="kw"><a href="reference/helpers.from.json.to.list.html">helpers.from.json.to.list</a></span>(<span class="st">'[</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">    ["id", "age", "name"],</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">    ["1","39","Paul"],</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">    ["2","23","Jimmy"],</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="st">    ["3","36","Jane"],</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="st">    ["4","28","Judy"]</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="st">    ]'</span>)), <span class="dt">pretty =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">## {</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">##   "fields": [</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co">##       "name": ["id"],</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="co">##       "type": ["integer"]</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">##       "name": ["age"],</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">##       "type": ["integer"]</span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="co">##       "name": ["name"],</span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="co">##       "type": ["string"]</span></a>
<a class="sourceLine" id="cb35-14" title="14"><span class="co">##     }</span></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="co">##   ]</span></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="co">## }</span></a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">schema<span class="op">$</span>valid <span class="co"># true</span></a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">## [1] TRUE</span></a></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">toJSON</span>(</a>
<a class="sourceLine" id="cb38-2" title="2">  schema<span class="op">$</span>descriptor,</a>
<a class="sourceLine" id="cb38-3" title="3">  <span class="dt">pretty =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">## {</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co">##   "fields": [</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co">##       "name": ["id"],</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="co">##       "type": ["integer"],</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="co">##       "name": ["age"],</span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="co">##       "type": ["integer"],</span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb39-13" title="13"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb39-14" title="14"><span class="co">##       "name": ["name"],</span></a>
<a class="sourceLine" id="cb39-15" title="15"><span class="co">##       "type": ["string"],</span></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb39-17" title="17"><span class="co">##     }</span></a>
<a class="sourceLine" id="cb39-18" title="18"><span class="co">##   ],</span></a>
<a class="sourceLine" id="cb39-19" title="19"><span class="co">##   "missingValues": [</span></a>
<a class="sourceLine" id="cb39-20" title="20"><span class="co">##     [""]</span></a>
<a class="sourceLine" id="cb39-21" title="21"><span class="co">##   ]</span></a>
<a class="sourceLine" id="cb39-22" title="22"><span class="co">## }</span></a></code></pre></div>
<p>Now we have an inferred schema and it’s valid. We could cast data row against our schema. We provide a string input by an output will be cast correspondingly:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">toJSON</span>(</a>
<a class="sourceLine" id="cb40-2" title="2">  schema<span class="op">$</span><span class="kw">castRow</span>(<span class="kw"><a href="reference/helpers.from.json.to.list.html">helpers.from.json.to.list</a></span>(<span class="st">'["5", "66", "Sam"]'</span>)),</a>
<a class="sourceLine" id="cb40-3" title="3">  <span class="dt">pretty =</span> <span class="ot">TRUE</span>, <span class="dt">auto_unbox =</span> <span class="ot">TRUE</span>) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co">## [</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="co">##   5,</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="co">##   66,</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="co">##   "Sam"</span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="co">## ]</span></a></code></pre></div>
<p>But if we try provide some missing value to <code>age</code> field cast will fail because for now only one possible missing value is an empty string. Let’s update our schema:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">schema<span class="op">$</span><span class="kw">castRow</span>(<span class="kw"><a href="reference/helpers.from.json.to.list.html">helpers.from.json.to.list</a></span>(<span class="st">'["6", "N/A", "Walt"]'</span>))</a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co">## Error in schema$castRow(helpers.from.json.to.list("[\"6\", \"N/A\", \"Walt\"]")): There are 1 cast errors (see following - Wrong type for header: age and value: N/A</span></a></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co"># Cast error</span></a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">schema<span class="op">$</span>descriptor<span class="op">$</span>missingValues =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">''</span>, <span class="st">'NA'</span>)</a>
<a class="sourceLine" id="cb45-2" title="2">schema<span class="op">$</span><span class="kw">commit</span>()</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co">## [1] TRUE</span></a></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">schema<span class="op">$</span><span class="kw">castRow</span>(<span class="kw"><a href="reference/helpers.from.json.to.list.html">helpers.from.json.to.list</a></span>(<span class="st">'["6", "", "Walt"]'</span>))</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="co">## [1] 6</span></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co">## </span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="co">## NULL</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co">## [1] "Walt"</span></a></code></pre></div>
<p>We could save the schema to a local file. And we could continue the work in any time just loading it from the local file:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">schema<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="st">'schema.json'</span>)</a>
<a class="sourceLine" id="cb49-2" title="2">schema =<span class="st"> </span><span class="kw"><a href="reference/Schema.load.html">Schema.load</a></span>(<span class="st">'schema.json'</span>)</a></code></pre></div>
<p>It was only basic introduction to the <code>Schema</code> class. To learn more let’s take a look on <code>Schema</code> class API reference.</p>
</div>
<div id="working-with-field" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-field" class="anchor"></a>Working with Field</h2>
<p>Class represents field in the schema.</p>
<p>Data values can be cast to native R types. Casting a value will check the value is of the expected type, is in the correct format, and complies with any constraints imposed by a schema.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb50-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="dt">"name"</span><span class="fu">:</span> <span class="st">"birthday"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="dt">"type"</span><span class="fu">:</span> <span class="st">"date"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="dt">"format"</span><span class="fu">:</span> <span class="st">"default"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb50-5" title="5"><span class="dt">"constraints"</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="dt">"required"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="dt">"minimum"</span><span class="fu">:</span> <span class="st">"2015-05-30"</span></a>
<a class="sourceLine" id="cb50-8" title="8"><span class="fu">}</span></a>
<a class="sourceLine" id="cb50-9" title="9"><span class="fu">}</span></a></code></pre></div>
<p>Following code will not raise the exception, despite the fact our date is less than minimum constraints in the field, because we do not check constraints of the field descriptor</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">field =<span class="st"> </span>Field<span class="op">$</span><span class="kw">new</span>(<span class="kw"><a href="reference/helpers.from.json.to.list.html">helpers.from.json.to.list</a></span>(<span class="st">'{"name": "name", "type": "number"}'</span>))</a>
<a class="sourceLine" id="cb51-2" title="2">dateType =<span class="st"> </span>field<span class="op">$</span><span class="kw">cast_value</span>(<span class="st">'12345'</span>) <span class="co"># cast</span></a>
<a class="sourceLine" id="cb51-3" title="3">dateType <span class="co"># print the result</span></a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co">## [1] 12345</span></a></code></pre></div>
<p>And following example will raise exception, because we set flag ‘skip constraints’ to <code>false</code>, and our date is less than allowed by <code>minimum</code> constraints of the field. Exception will be raised as well in situation of trying to cast non-date format values, or empty values</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span>(</a>
<a class="sourceLine" id="cb53-2" title="2">  <span class="dt">dateType =</span> field<span class="op">$</span><span class="kw">cast_value</span>(<span class="dt">value =</span> <span class="st">'2014-05-29'</span>, <span class="dt">constraints =</span> <span class="ot">FALSE</span>), </a>
<a class="sourceLine" id="cb53-3" title="3">  <span class="dt">error =</span> <span class="cf">function</span>(e){<span class="co"># uh oh, something went wrong</span></a>
<a class="sourceLine" id="cb53-4" title="4">  })</a></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co">## Error in private$castValue(...): Field character(0) can't cast value 2014-05-29 for type number with format default</span></a></code></pre></div>
<p>Values that can’t be cast will raise an <code>Error</code> exception. Casting a value that doesn’t meet the constraints will raise an <code>Error</code> exception.</p>
<p>Table below shows the available types, formats and resultant value of the cast:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Type</th>
<th align="left">Formats</th>
<th align="left">Casting result</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">any</td>
<td align="left">default</td>
<td align="left">Any</td>
</tr>
<tr class="even">
<td align="left">list</td>
<td align="left"></td>
<td align="left">default</td>
</tr>
<tr class="odd">
<td align="left">boolean</td>
<td align="left">default</td>
<td align="left">Boolean</td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">default, any</td>
<td align="left">Date</td>
</tr>
<tr class="odd">
<td align="left">datetime</td>
<td align="left">default, any</td>
<td align="left">Date</td>
</tr>
<tr class="even">
<td align="left">duration</td>
<td align="left">default</td>
<td align="left">Duration</td>
</tr>
<tr class="odd">
<td align="left">geojson</td>
<td align="left">default, topojson</td>
<td align="left">Object</td>
</tr>
<tr class="even">
<td align="left">geopoint</td>
<td align="left">default, list, object</td>
<td align="left">[Number, Number]</td>
</tr>
<tr class="odd">
<td align="left">integer</td>
<td align="left">default</td>
<td align="left">Number</td>
</tr>
<tr class="even">
<td align="left">number</td>
<td align="left">default</td>
<td align="left">Number</td>
</tr>
<tr class="odd">
<td align="left">object</td>
<td align="left">default</td>
<td align="left">Object</td>
</tr>
<tr class="even">
<td align="left">string</td>
<td align="left">default, uri, email, binary</td>
<td align="left">String</td>
</tr>
<tr class="odd">
<td align="left">time</td>
<td align="left">default, any</td>
<td align="left">Date</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="left">default</td>
<td align="left">Number</td>
</tr>
<tr class="odd">
<td align="left">yearmonth</td>
<td align="left">default</td>
<td align="left">[Number, Number]</td>
</tr>
</tbody>
</table>
<div id="working-with-validate" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-validate" class="anchor"></a>Working with Validate</h3>
<blockquote>
<p><code><a href="reference/validate.html">validate()</a></code> validates whether a <strong>schema</strong> is a validate Table Schema accordingly to the <a href="https://frictionlessdata.io/schemas/table-schema.json">specifications</a>. It does <strong>not</strong> validate data against a schema.</p>
</blockquote>
<p>Given a schema descriptor <code>validate</code> returns a validation object:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">valid_errors =<span class="st"> </span><span class="kw"><a href="reference/validate.html">validate</a></span>(<span class="st">'inst/extdata/schema.json'</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">valid_errors</a></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co">## $valid</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="co">## </span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="co">## $errors</span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="co">## list()</span></a></code></pre></div>
</div>
<div id="working-with-infer" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-infer" class="anchor"></a>Working with Infer</h3>
<p>Given data source and headers <code>infer</code> will return a Table Schema as a JSON object based on the data values.</p>
<p>Given the data file, example.csv:</p>
<pre class="csv"><code>id,age,name
1,39,Paul
2,23,Jimmy
3,36,Jane
4,28,Judy</code></pre>
<p>Call <code>infer</code> with headers and values from the datafile:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">descriptor =<span class="st"> </span><span class="kw"><a href="reference/infer.html">infer</a></span>(<span class="st">'inst/extdata/data_infer.csv'</span>)</a></code></pre></div>
<p>The <code>descriptor</code> variable is now a list object that can easily converted to JSON:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">toJSON</span>(</a>
<a class="sourceLine" id="cb59-2" title="2">  descriptor,</a>
<a class="sourceLine" id="cb59-3" title="3">  <span class="dt">pretty =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb59-4" title="4">) <span class="co"># function from jsonlite package</span></a></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co">## {</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="co">##   "fields": [</span></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="co">##       "name": ["id"],</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="co">##       "type": ["integer"],</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb60-7" title="7"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb60-8" title="8"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="co">##       "name": ["age"],</span></a>
<a class="sourceLine" id="cb60-10" title="10"><span class="co">##       "type": ["integer"],</span></a>
<a class="sourceLine" id="cb60-11" title="11"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb60-12" title="12"><span class="co">##     },</span></a>
<a class="sourceLine" id="cb60-13" title="13"><span class="co">##     {</span></a>
<a class="sourceLine" id="cb60-14" title="14"><span class="co">##       "name": ["name"],</span></a>
<a class="sourceLine" id="cb60-15" title="15"><span class="co">##       "type": ["string"],</span></a>
<a class="sourceLine" id="cb60-16" title="16"><span class="co">##       "format": ["default"]</span></a>
<a class="sourceLine" id="cb60-17" title="17"><span class="co">##     }</span></a>
<a class="sourceLine" id="cb60-18" title="18"><span class="co">##   ],</span></a>
<a class="sourceLine" id="cb60-19" title="19"><span class="co">##   "missingValues": [</span></a>
<a class="sourceLine" id="cb60-20" title="20"><span class="co">##     [""]</span></a>
<a class="sourceLine" id="cb60-21" title="21"><span class="co">##   ]</span></a>
<a class="sourceLine" id="cb60-22" title="22"><span class="co">## }</span></a></code></pre></div>
</div>
</div>
<div id="api-reference" class="section level2">
<h2 class="hasAnchor">
<a href="#api-reference" class="anchor"></a>API Reference</h2>
<div id="table" class="section level3">
<h3 class="hasAnchor">
<a href="#table" class="anchor"></a>Table</h3>
<p>Table representation</p>
<ul>
<li>
<a href="#Table">Table</a>
<ul>
<li>
<em>instance</em>
<ul>
<li>
<a href="#Table+headers">$headers</a> ⇒ <code>List.&lt;string&gt;</code>
</li>
<li>
<a href="#Table+schema">$schema</a> ⇒ <code>Schema</code>
</li>
<li>
<a href="#Table+iter">$iter(keyed, extended, cast, forceCast, relations, stream)</a> ⇒ <code>AsyncIterator</code> | <code>Stream</code>
</li>
<li>
<a href="#Table+read">$read(limit)</a> ⇒ <code>List.&lt;List&gt;</code> | <code>List.&lt;Object&gt;</code>
</li>
<li>
<a href="#Table+infer">$infer(limit)</a> ⇒ <code>Object</code>
</li>
<li>
<a href="#Table+save">$save(target)</a> ⇒ <code>Boolean</code>
</li>
</ul>
</li>
<li>
<em>static</em>
<ul>
<li>
<a href="#Table.load">.load(source, schema, strict, headers, parserOptions)</a> ⇒ <a href="#Table"><code>Table</code></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div id="tableheaders--liststring" class="section level4">
<h4 class="hasAnchor">
<a href="#tableheaders--liststring" class="anchor"></a>table$headers ⇒ <code>List.&lt;string&gt;</code>
</h4>
<p>Headers</p>
<p><strong>Returns</strong>: <code>List.&lt;string&gt;</code> - data source headers</p>
</div>
<div id="tableschema--schema" class="section level4">
<h4 class="hasAnchor">
<a href="#tableschema--schema" class="anchor"></a>table$schema ⇒ <code>Schema</code>
</h4>
<p>Schema</p>
<p><strong>Returns</strong>: <code>Schema</code> - table schema instance</p>
</div>
<div id="tableiterkeyed-extended-cast-forcecast-relations-stream--asynciterator--stream" class="section level4">
<h4 class="hasAnchor">
<a href="#tableiterkeyed-extended-cast-forcecast-relations-stream--asynciterator--stream" class="anchor"></a>table$iter(keyed, extended, cast, forceCast, relations, stream) ⇒ <code>AsyncIterator</code> | <code>Stream</code>
</h4>
<p>Iterate through the table data</p>
<p>And emits rows cast based on table schema (async for loop). With a <code>stream</code> flag instead of async iterator a Node stream will be returned. Data casting can be disabled.</p>
<p><strong>Returns</strong>: <code>AsyncIterator</code> | <code>Stream</code> - async iterator/stream of rows: - <code>[value1, value2]</code> - base - <code>{header1: value1, header2: value2}</code> - keyed - <code>[rowNumber, [header1, header2], [value1, value2]]</code> - extended <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occurred in this process</li>
</ul>
<table class="table">
<colgroup>
<col width="2%">
<col width="6%">
<col width="90%">
</colgroup>
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>keyed</td>
<td><code>boolean</code></td>
<td>iter keyed rows</td>
</tr>
<tr class="even">
<td>extended</td>
<td><code>boolean</code></td>
<td>iter extended rows</td>
</tr>
<tr class="odd">
<td>cast</td>
<td><code>boolean</code></td>
<td>disable data casting if false</td>
</tr>
<tr class="even">
<td>forceCast</td>
<td><code>boolean</code></td>
<td>instead of raising on the first row with cast error return an error object to replace failed row. It will allow to iterate over the whole data file even if it’s not compliant to the schema. Example of output stream: <code>[['val1', 'val2'], TableSchemaError, ['val3', 'val4'], ...]</code>
</td>
</tr>
<tr class="odd">
<td>relations</td>
<td><code>Object</code></td>
<td>object of foreign key references in a form of <code>{resource1: [{field1: value1, field2: value2}, ...], ...}</code>. If provided foreign key fields will checked and resolved to its references</td>
</tr>
<tr class="even">
<td>stream</td>
<td><code>boolean</code></td>
<td>return Node Readable Stream of table rows</td>
</tr>
</tbody>
</table>
</div>
<div id="tablereadlimit--listlist--listobject" class="section level4">
<h4 class="hasAnchor">
<a href="#tablereadlimit--listlist--listobject" class="anchor"></a>table$read(limit) ⇒ <code>List.&lt;List&gt;</code> | <code>List.&lt;Object&gt;</code>
</h4>
<p>Read the table data into memory</p>
<blockquote>
<p>The API is the same as <code>table.iter</code> has except for:</p>
</blockquote>
<p><strong>Returns</strong>: <code>List.&lt;List&gt;</code> | <code>List.&lt;Object&gt;</code> - list of rows: - <code>[value1, value2]</code> - base - <code>{header1: value1, header2: value2}</code> - keyed - <code>[rowNumber, [header1, header2], [value1, value2]]</code> - extended</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>limit</td>
<td><code>integer</code></td>
<td>limit of rows to read</td>
</tr></tbody>
</table>
</div>
<div id="tableinferlimit--object" class="section level4">
<h4 class="hasAnchor">
<a href="#tableinferlimit--object" class="anchor"></a>table$infer(limit) ⇒ <code>Object</code>
</h4>
<p>Infer a schema for the table.</p>
<p>It will infer and set Table Schema to <code>table.schema</code> based on table data.</p>
<p><strong>Returns</strong>: <code>Object</code> - Table Schema descriptor</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>limit</td>
<td><code>number</code></td>
<td>limit rows sample size</td>
</tr></tbody>
</table>
</div>
<div id="tablesavetarget--boolean" class="section level4">
<h4 class="hasAnchor">
<a href="#tablesavetarget--boolean" class="anchor"></a>table$save(target) ⇒ <code>Boolean</code>
</h4>
<p>Save data source to file locally in CSV format with <code>,</code> (comma) delimiter</p>
<p><strong>Returns</strong>: <code>Boolean</code> - true on success <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> an error if there is saving problem</li>
</ul>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>target</td>
<td><code>string</code></td>
<td>path where to save a table data</td>
</tr></tbody>
</table>
</div>
<div id="tableloadsource-schema-strict-headers-parseroptions--table" class="section level4">
<h4 class="hasAnchor">
<a href="#tableloadsource-schema-strict-headers-parseroptions--table" class="anchor"></a>Table.load(source, schema, strict, headers, parserOptions) ⇒ <a href="#Table"><code>Table</code></a>
</h4>
<p>Factory method to instantiate <code>Table</code> class.</p>
<p>This method is async and it should be used with await keyword or as a <code>Promise</code>. If <code>references</code> argument is provided foreign keys will be checked on any reading operation.</p>
<p><strong>Returns</strong>: <a href="#Table"><code>Table</code></a> - data table class instance <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occurred in table creation process</li>
</ul>
<table class="table">
<colgroup>
<col width="4%">
<col width="29%">
<col width="66%">
</colgroup>
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>source</td>
<td><code>string</code></td>
<td><code>List.&lt;List&gt;</code></td>
</tr>
<tr class="even">
<td>schema</td>
<td><code>string</code></td>
<td><code>Object</code></td>
</tr>
<tr class="odd">
<td>strict</td>
<td><code>boolean</code></td>
<td>strictness option to pass to <code>Schema</code> constructor</td>
</tr>
<tr class="even">
<td>headers</td>
<td><code>number</code></td>
<td><code>List.&lt;string&gt;</code></td>
</tr>
<tr class="odd">
<td>parserOptions</td>
<td><code>Object</code></td>
<td>options to be used by CSV parser. All options listed at <a href="https://csv.js.org/parse/options/" class="uri">https://csv.js.org/parse/options/</a>. By default <code>ltrim</code> is true according to the CSV Dialect spec.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="schema" class="section level3">
<h3 class="hasAnchor">
<a href="#schema" class="anchor"></a>Schema</h3>
<p>Schema representation</p>
<ul>
<li>
<a href="#Schema">Schema</a>
<ul>
<li>
<em>instance</em>
<ul>
<li>
<a href="#Schema+valid">$valid</a> ⇒ <code>Boolean</code>
</li>
<li>
<a href="#Schema+errors">$errors</a> ⇒ <code>List.&lt;Error&gt;</code>
</li>
<li>
<a href="#Schema+descriptor">$descriptor</a> ⇒ <code>Object</code>
</li>
<li>
<a href="#Schema+primaryKey">$primaryKey</a> ⇒ <code>List.&lt;string&gt;</code>
</li>
<li>
<a href="#Schema+foreignKeys">$foreignKeys</a> ⇒ <code>List.&lt;Object&gt;</code>
</li>
<li>
<a href="#Schema+fields">$fields</a> ⇒ <code>List.&lt;Field&gt;</code>
</li>
<li>
<a href="#Schema+fieldNames">$fieldNames</a> ⇒ <code>List.&lt;string&gt;</code>
</li>
<li>
<a href="#Schema+getField">$getField(fieldName)</a> ⇒ <code>Field</code> | <code>null</code>
</li>
<li>
<a href="#Schema+addField">$addField(descriptor)</a> ⇒ <code>Field</code>
</li>
<li>
<a href="#Schema+removeField">$removeField(name)</a> ⇒ <code>Field</code> | <code>null</code>
</li>
<li>
<a href="#Schema+castRow">$castRow(row, failFalst)</a> ⇒ <code>List.&lt;List&gt;</code>
</li>
<li>
<a href="#Schema+infer">$infer(rows, headers)</a> ⇒ <code>Object</code>
</li>
<li>
<a href="#Schema+commit">$commit(strict)</a> ⇒ <code>Boolean</code>
</li>
<li>
<a href="#Schema+save">$save(target)</a> ⇒ <code>boolean</code>
</li>
</ul>
</li>
<li>
<em>static</em>
<ul>
<li>
<a href="#Schema.load">.load(descriptor, strict)</a> ⇒ <a href="#Schema"><code>Schema</code></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div id="schemavalid--boolean" class="section level4">
<h4 class="hasAnchor">
<a href="#schemavalid--boolean" class="anchor"></a>schema$valid ⇒ <code>Boolean</code>
</h4>
<p>Validation status</p>
<p>It always <code>true</code> in strict mode.</p>
<p><strong>Returns</strong>: <code>Boolean</code> - returns validation status</p>
</div>
<div id="schemaerrors--listerror" class="section level4">
<h4 class="hasAnchor">
<a href="#schemaerrors--listerror" class="anchor"></a>schema$errors ⇒ <code>List.&lt;Error&gt;</code>
</h4>
<p>Validation errors</p>
<p>It always empty in strict mode.</p>
<p><strong>Returns</strong>: <code>List.&lt;Error&gt;</code> - returns validation errors</p>
</div>
<div id="schemadescriptor--object" class="section level4">
<h4 class="hasAnchor">
<a href="#schemadescriptor--object" class="anchor"></a>schema$descriptor ⇒ <code>Object</code>
</h4>
<p>Descriptor</p>
<p><strong>Returns</strong>: <code>Object</code> - schema descriptor</p>
</div>
<div id="schemaprimarykey--liststring" class="section level4">
<h4 class="hasAnchor">
<a href="#schemaprimarykey--liststring" class="anchor"></a>schema$primaryKey ⇒ <code>List.&lt;string&gt;</code>
</h4>
<p>Primary Key</p>
<p><strong>Returns</strong>: <code>List.&lt;string&gt;</code> - schema primary key</p>
</div>
<div id="schemaforeignkeys--listobject" class="section level4">
<h4 class="hasAnchor">
<a href="#schemaforeignkeys--listobject" class="anchor"></a>schema$foreignKeys ⇒ <code>List.&lt;Object&gt;</code>
</h4>
<p>Foreign Keys</p>
<p><strong>Returns</strong>: <code>List.&lt;Object&gt;</code> - schema foreign keys</p>
</div>
<div id="schemafields--listfield" class="section level4">
<h4 class="hasAnchor">
<a href="#schemafields--listfield" class="anchor"></a>schema$fields ⇒ <code>List.&lt;Field&gt;</code>
</h4>
<p>Fields</p>
<p><strong>Returns</strong>: <code>List.&lt;Field&gt;</code> - schema fields</p>
</div>
<div id="schemafieldnames--liststring" class="section level4">
<h4 class="hasAnchor">
<a href="#schemafieldnames--liststring" class="anchor"></a>schema$fieldNames ⇒ <code>List.&lt;string&gt;</code>
</h4>
<p>Field names</p>
<p><strong>Returns</strong>: <code>List.&lt;string&gt;</code> - schema field names</p>
</div>
<div id="schemagetfieldfieldname--field--null" class="section level4">
<h4 class="hasAnchor">
<a href="#schemagetfieldfieldname--field--null" class="anchor"></a>schema$getField(fieldName) ⇒ <code>Field</code> | <code>null</code>
</h4>
<p>Return a field</p>
<p><strong>Returns</strong>: <code>Field</code> | <code>null</code> - field instance if exists</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
</tr></thead>
<tbody><tr class="odd">
<td>fieldName</td>
<td><code>string</code></td>
</tr></tbody>
</table>
</div>
<div id="schemaaddfielddescriptor--field" class="section level4">
<h4 class="hasAnchor">
<a href="#schemaaddfielddescriptor--field" class="anchor"></a>schema$addField(descriptor) ⇒ <code>Field</code>
</h4>
<p>Add a field</p>
<p><strong>Returns</strong>: <code>Field</code> - added field instance</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
</tr></thead>
<tbody><tr class="odd">
<td>descriptor</td>
<td><code>Object</code></td>
</tr></tbody>
</table>
</div>
<div id="schemaremovefieldname--field--null" class="section level4">
<h4 class="hasAnchor">
<a href="#schemaremovefieldname--field--null" class="anchor"></a>schema$removeField(name) ⇒ <code>Field</code> | <code>null</code>
</h4>
<p>Remove a field</p>
<p><strong>Returns</strong>: <code>Field</code> | <code>null</code> - removed field instance if exists</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
</tr></thead>
<tbody><tr class="odd">
<td>name</td>
<td><code>string</code></td>
</tr></tbody>
</table>
</div>
<div id="schemacastrowrow-failfalst--listlist" class="section level4">
<h4 class="hasAnchor">
<a href="#schemacastrowrow-failfalst--listlist" class="anchor"></a>schema$castRow(row, failFalst) ⇒ <code>List.&lt;List&gt;</code>
</h4>
<p>Cast row based on field types and formats.</p>
<p><strong>Returns</strong>: <code>List.&lt;List&gt;</code> - cast data row</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>row</td>
<td><code>List.&lt;List&gt;</code></td>
<td>data row as an list of values</td>
</tr>
<tr class="even">
<td>failFalst</td>
<td><code>boolean</code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="schemainferrows-headers--object" class="section level4">
<h4 class="hasAnchor">
<a href="#schemainferrows-headers--object" class="anchor"></a>schema$infer(rows, headers) ⇒ <code>Object</code>
</h4>
<p>Infer and set <code>schema.descriptor</code> based on data sample.</p>
<p><strong>Returns</strong>: <code>Object</code> - Table Schema descriptor</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>rows</td>
<td><code>List.&lt;List&gt;</code></td>
<td>list of lists representing rows</td>
</tr>
<tr class="even">
<td>headers</td>
<td><code>integer</code></td>
<td><code>List.&lt;string&gt;</code></td>
</tr>
</tbody>
</table>
</div>
<div id="schemacommitstrict--boolean" class="section level4">
<h4 class="hasAnchor">
<a href="#schemacommitstrict--boolean" class="anchor"></a>schema$commit(strict) ⇒ <code>Boolean</code>
</h4>
<p>Update schema instance if there are in-place changes in the descriptor.</p>
<p><strong>Returns</strong>: <code>Boolean</code> - returns true on success and false if not modified <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occurred in the process</li>
</ul>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>strict</td>
<td><code>boolean</code></td>
<td>alter <code>strict</code> mode for further work</td>
</tr></tbody>
</table>
<p><strong>Example</strong></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">descriptor &lt;-<span class="st"> '{"fields": [{"name": "field", "type": "string"}]}'</span></a>
<a class="sourceLine" id="cb61-2" title="2">def &lt;-<span class="st"> </span><span class="kw"><a href="reference/Schema.load.html">Schema.load</a></span>(descriptor)</a>
<a class="sourceLine" id="cb61-3" title="3">schema &lt;-<span class="st"> </span><span class="kw">value</span>(def)</a>
<a class="sourceLine" id="cb61-4" title="4">schema<span class="op">$</span><span class="kw">getField</span>(<span class="st">'name'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co">## NULL</span></a></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">schema<span class="op">$</span>descriptor<span class="op">$</span>fields[[<span class="dv">1</span>]]<span class="op">$</span>type</a></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co">## [1] "string"</span></a></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">schema<span class="op">$</span>descriptor<span class="op">$</span>fields[[<span class="dv">1</span>]]<span class="op">$</span>type &lt;-<span class="st">'number'</span></a>
<a class="sourceLine" id="cb65-2" title="2">schema<span class="op">$</span>descriptor<span class="op">$</span>fields[[<span class="dv">1</span>]]<span class="op">$</span>type</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="co">## [1] "number"</span></a></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">schema<span class="op">$</span><span class="kw">commit</span>()</a></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co">## [1] TRUE</span></a></code></pre></div>
</div>
<div id="schemasavetarget--boolean" class="section level4">
<h4 class="hasAnchor">
<a href="#schemasavetarget--boolean" class="anchor"></a>schema$save(target) ⇒ <code>boolean</code>
</h4>
<p>Save schema descriptor to target destination.</p>
<p><strong>Returns</strong>: <code>boolean</code> - returns true on success <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occurred in the process</li>
</ul>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>target</td>
<td><code>string</code></td>
<td>path where to save a descriptor</td>
</tr></tbody>
</table>
</div>
<div id="schemaloaddescriptor-strict--schema" class="section level4">
<h4 class="hasAnchor">
<a href="#schemaloaddescriptor-strict--schema" class="anchor"></a>Schema.load(descriptor, strict) ⇒ <a href="#Schema"><code>Schema</code></a>
</h4>
<p>Factory method to instantiate <code>Schema</code> class.</p>
<p>This method is async and it should be used with await keyword or as a <code>Promise</code>.</p>
<p><strong>Returns</strong>: <a href="#Schema"><code>Schema</code></a> - returns schema class instance <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occurred in the process</li>
</ul>
<table class="table">
<colgroup>
<col width="4%">
<col width="17%">
<col width="78%">
</colgroup>
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>descriptor</td>
<td><code>string</code></td>
<td><code>Object</code></td>
</tr>
<tr class="even">
<td>strict</td>
<td><code>boolean</code></td>
<td>flag to alter validation behaviour: - if false error will not be raised and all error will be collected in <code>schema.errors</code> - if strict is true any validation error will be raised immediately</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="field" class="section level3">
<h3 class="hasAnchor">
<a href="#field" class="anchor"></a>Field</h3>
<p>Field representation</p>
<ul>
<li>
<a href="#Field">Field</a>
<ul>
<li><a href="#new_Field_new">new Field(descriptor, missingValues)</a></li>
<li>
<a href="#Field+name">$name</a> ⇒ <code>string</code>
</li>
<li>
<a href="#Field+type">$type</a> ⇒ <code>string</code>
</li>
<li>
<a href="#Field+format">$format</a> ⇒ <code>string</code>
</li>
<li>
<a href="#Field+required">$required</a> ⇒ <code>boolean</code>
</li>
<li>
<a href="#Field+constraints">$constraints</a> ⇒ <code>Object</code>
</li>
<li>
<a href="#Field+descriptor">$descriptor</a> ⇒ <code>Object</code>
</li>
<li>
<a href="#Field+castValue">$castValue(value, constraints)</a> ⇒ <code>any</code>
</li>
<li>
<a href="#Field+testValue">$testValue(value, constraints)</a> ⇒ <code>boolean</code>
</li>
</ul>
</li>
</ul>
<div id="new-fielddescriptor-missingvalues" class="section level4">
<h4 class="hasAnchor">
<a href="#new-fielddescriptor-missingvalues" class="anchor"></a>new Field(descriptor, missingValues)</h4>
<p>Constructor to instantiate <code>Field</code> class.</p>
<p><strong>Returns</strong>: <a href="#Field"><code>Field</code></a> - returns field class instance <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occured in the process</li>
</ul>
<table class="table">
<colgroup>
<col width="14%">
<col width="31%">
<col width="53%">
</colgroup>
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>descriptor</td>
<td><code>Object</code></td>
<td>schema field descriptor</td>
</tr>
<tr class="even">
<td>missingValues</td>
<td><code>List.&lt;string&gt;</code></td>
<td>an list with string representing missing values</td>
</tr>
</tbody>
</table>
</div>
<div id="fieldname--string" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldname--string" class="anchor"></a>field$name ⇒ <code>string</code>
</h4>
<p>Field name</p>
</div>
<div id="fieldtype--string" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldtype--string" class="anchor"></a>field$type ⇒ <code>string</code>
</h4>
<p>Field type</p>
</div>
<div id="fieldformat--string" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldformat--string" class="anchor"></a>field$format ⇒ <code>string</code>
</h4>
<p>Field format</p>
</div>
<div id="fieldrequired--boolean" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldrequired--boolean" class="anchor"></a>field$required ⇒ <code>boolean</code>
</h4>
<p>Return true if field is required</p>
</div>
<div id="fieldconstraints--object" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldconstraints--object" class="anchor"></a>field$constraints ⇒ <code>Object</code>
</h4>
<p>Field constraints</p>
</div>
<div id="fielddescriptor--object" class="section level4">
<h4 class="hasAnchor">
<a href="#fielddescriptor--object" class="anchor"></a>field$descriptor ⇒ <code>Object</code>
</h4>
<p>Field descriptor</p>
</div>
<div id="fieldcastvaluevalue-constraints--any" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldcastvaluevalue-constraints--any" class="anchor"></a>field$castValue(value, constraints) ⇒ <code>any</code>
</h4>
<p>Cast value</p>
<p><strong>Returns</strong>: <code>any</code> - cast value</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>value</td>
<td><code>any</code></td>
<td>value to cast</td>
</tr>
<tr class="even">
<td>constraints</td>
<td><code>Object</code></td>
<td><code>false</code></td>
</tr>
</tbody>
</table>
</div>
<div id="fieldtestvaluevalue-constraints--boolean" class="section level4">
<h4 class="hasAnchor">
<a href="#fieldtestvaluevalue-constraints--boolean" class="anchor"></a>field$testValue(value, constraints) ⇒ <code>boolean</code>
</h4>
<p>Check if value can be cast</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>value</td>
<td><code>any</code></td>
<td>value to test</td>
</tr>
<tr class="even">
<td>constraints</td>
<td><code>Object</code></td>
<td><code>false</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="validatedescriptor--object" class="section level3">
<h3 class="hasAnchor">
<a href="#validatedescriptor--object" class="anchor"></a>validate(descriptor) ⇒ <code>Object</code>
</h3>
<p>This function is async so it has to be used with <code>await</code> keyword or as a <code>Promise</code>.</p>
<p><strong>Returns</strong>: <code>Object</code> - returns <code>{valid, errors}</code> object</p>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>descriptor</td>
<td><code>string</code></td>
<td><code>Object</code></td>
</tr></tbody>
</table>
</div>
<div id="infersource-headers-options--object" class="section level3">
<h3 class="hasAnchor">
<a href="#infersource-headers-options--object" class="anchor"></a>infer(source, headers, options) ⇒ <code>Object</code>
</h3>
<p>This function is async so it has to be used with <code>await</code> keyword or as a <code>Promise</code>.</p>
<p><strong>Returns</strong>: <code>Object</code> - returns schema descriptor <strong>Throws</strong>:</p>
<ul>
<li>
<code>TableSchemaError</code> raises any error occured in the process</li>
</ul>
<table class="table">
<thead><tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>source</td>
<td><code>string</code></td>
<td><code>List.&lt;List&gt;</code></td>
</tr>
<tr class="even">
<td>headers</td>
<td><code>List.&lt;string&gt;</code></td>
<td>list of headers</td>
</tr>
<tr class="odd">
<td>options</td>
<td><code>Object</code></td>
<td>any <code>Table.load</code> options</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="contributing" class="section level1">
<h1 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h1>
<p>The project follows the <a href="https://github.com/okfn/coding-standards">Open Knowledge International coding standards</a>. There are common commands to work with the project.Recommended way to get started is to create, activate and load the library environment. To install package and development dependencies into active environment:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"frictionlessdata/tableschema-r"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>To make test:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">test_that</span>(description, {</a>
<a class="sourceLine" id="cb70-2" title="2">  <span class="kw">expect_equal</span>(test, expected result)</a>
<a class="sourceLine" id="cb70-3" title="3">})</a></code></pre></div>
<p>To run tests:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/test.html">test</a></span>()</a></code></pre></div>
<p>More detailed information about how to create and run tests you can find in <a href="https://github.com/hadley/testthat">testthat package</a>.</p>
<div id="changelog---news" class="section level2">
<h2 class="hasAnchor">
<a href="#changelog---news" class="anchor"></a>Changelog - News</h2>
<p>In <a href="https://github.com/frictionlessdata/tableschema-r/blob/master/NEWS.md">NEWS.md</a> described only breaking and the most important changes. The full changelog could be found in nicely formatted <a href="https://github.com/frictionlessdata/tableschema-r/commits/master">commit</a> history.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=tableschema.r">https://​cloud.r-project.org/​package=tableschema.r</a>
</li>
<li>Browse source code at <br><a href="https://github.com/frictionlessdata/tableschema-r">https://​github.com/​frictionlessdata/​tableschema-r</a>
</li>
<li>Report a bug at <br><a href="https://github.com/frictionlessdata/tableschema-r/issues">https://​github.com/​frictionlessdata/​tableschema-r/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kleanthis Koupidis <br><small class="roles"> Author, maintainer </small>  </li>
<li>Lazaros Ioannidis <br><small class="roles"> Author </small>  </li>
<li>Charalampos Bratsas <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kleanthis Koupidis, Lazaros Ioannidis, Charalampos Bratsas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
